# RWA Launchpad - å®Œæ•´RWAç”Ÿæ€ç³»ç»Ÿ

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

RWA Launchpadæ˜¯ä¸€ä¸ªå®Œæ•´çš„å»ä¸­å¿ƒåŒ–äº¤æ˜“æ‰€(DEX)ç”Ÿæ€ç³»ç»Ÿï¼Œé€šè¿‡å·¥å‚æ¨¡å¼å®ç°ä¸€é”®éƒ¨ç½²ï¼ŒåŒ…å«å®Œæ•´çš„ä»£å¸ç»æµã€äº¤æ˜“å¸‚åœºã€å€Ÿè´·é“¶è¡Œã€è´¨æŠ¼æ± å’Œè¾…åŠ©å·¥å…·ç³»ç»Ÿã€‚

### ğŸŒŸ é¡¹ç›®æ„¿æ™¯
- **ä¸€é”®éƒ¨ç½²**: é€šè¿‡å·¥å‚åˆçº¦å¿«é€Ÿåˆ›å»ºå®Œæ•´DEXç³»ç»Ÿ
- **æ¨¡å—åŒ–è®¾è®¡**: æ ¸å¿ƒåŠŸèƒ½åˆ†ç¦»ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•
- **å¤šåœºæ™¯æ”¯æŒ**: ä»åŸå‹éªŒè¯åˆ°ç”Ÿäº§éƒ¨ç½²çš„å®Œæ•´è§£å†³æ–¹æ¡ˆ
- **ç”Ÿæ€å®Œæ•´**: ä»£å¸ã€äº¤æ˜“ã€å€Ÿè´·ã€è´¨æŠ¼çš„å®Œæ•´DeFié—­ç¯

### ğŸ¯ ç›®æ ‡ç”¨æˆ·
- **DeFié¡¹ç›®æ–¹**: å¿«é€Ÿéƒ¨ç½²è‡ªå·±çš„DEXç³»ç»Ÿ
- **å¼€å‘è€…**: å­¦ä¹ å’Œç ”ç©¶DEXæ¶æ„
- **æŠ•èµ„æœºæ„**: æ‰¹é‡éƒ¨ç½²å¤šä¸ªé¡¹ç›®
- **ä¸ªäººç”¨æˆ·**: ä½“éªŒå®Œæ•´çš„DeFiç”Ÿæ€ç³»ç»Ÿ

## ğŸš€ æ ¸å¿ƒç‰¹æ€§

### ğŸ—ï¸ å·¥å‚åŒ–éƒ¨ç½²
- **ä¸€é”®éƒ¨ç½²**: `deployWithPreset()` å•å‡½æ•°è°ƒç”¨åˆ›å»ºå®Œæ•´DEX
- **åˆ†æ­¥éƒ¨ç½²**: æ”¯æŒ4é˜¶æ®µéƒ¨ç½²ï¼šåˆ›å»ºâ†’ä»£å¸â†’æ ¸å¿ƒâ†’å®Œæˆ
- **åŒæ¨¡å¼æ”¯æŒ**: å¿«é€ŸåŸå‹æ¨¡å¼(MockToken) + ç”Ÿäº§éƒ¨ç½²æ¨¡å¼(Clones)
- **é¢„è®¾é…ç½®**: ä¿å®ˆå‹ã€å¹³è¡¡å‹ã€æ¿€è¿›å‹ä¸‰ç§é£é™©é…ç½®

### ğŸ’° ä»£å¸ç»æµç³»ç»Ÿ
- **ä¸‰å¸æ¶æ„**: RWA(æ²»ç†ä»£å¸) + prRWA(è´¨æŠ¼å¥–åŠ±) + STABLE_RWA(å€Ÿè´·ä»£å¸)
- **åŠ¨æ€é“¸é€ **: åŸºäºè´¨æŠ¼é‡çš„prRWAæŒ‰æ—¥é“¸é€ åˆ†é…
- **æƒé™æ§åˆ¶**: åŸºäºAccessControlçš„ç²¾ç»†æƒé™ç®¡ç†
- **ç»æµæ¨¡å‹**: å¯é…ç½®çš„é“¸é€ ç‡ã€è´¹ç”¨å’Œåˆ†é…æƒé‡

### ğŸ”„ æ™ºèƒ½äº¤æ˜“æœºåˆ¶
- **åŠ¨æ€å®šä»·**: åŸºäºAMMç®—æ³•çš„è‡ªé€‚åº”ä»·æ ¼å‘ç°
- **èµ„é‡‘ç‡ç®¡ç†**: ç›®æ ‡èµ„é‡‘ç‡è‡ªåŠ¨è°ƒèŠ‚æœºåˆ¶
- **åœ°æ¿ä»·ä¿æŠ¤**: åªæ¶¨ä¸è·Œçš„åœ°æ¿ä»·æœºåˆ¶
- **å¤šç¨³å®šå¸**: æ”¯æŒUSDCã€USDTç­‰ä¸»æµç¨³å®šå¸

### ğŸ¦ å€Ÿè´·ç³»ç»Ÿ
- **è´¨æŠ¼å€Ÿè´·**: åŸºäºè´¨æŠ¼RWAçš„STABLE_RWAå€Ÿè´·æœåŠ¡
- **åŠ¨æ€é¢åº¦**: å€Ÿæ¬¾ä¸Šé™ = è´¨æŠ¼RWA Ã— åœ°æ¿ä»·
- **è´¹ç”¨ç®¡ç†**: å¯é…ç½®å€Ÿæ¬¾è´¹ç‡(æ¨è3-5%)
- **å€ºåŠ¡è·Ÿè¸ª**: å®æ—¶ç”¨æˆ·å€ºåŠ¡ç®¡ç†å’Œå¯æå–é¢åº¦è®¡ç®—

## ğŸ›ï¸ æŠ€æœ¯æ¶æ„

```
RWA Launchpad/
â”œâ”€â”€ ğŸ“ contracts/
â”‚   â”œâ”€â”€ ğŸ“ core/                    # æ ¸å¿ƒä¸šåŠ¡åˆçº¦
â”‚   â”‚   â”œâ”€â”€ ğŸ“ Bank/               # å€Ÿè´·é“¶è¡Œ
â”‚   â”‚   â”‚   â””â”€â”€ Bank.sol           # å€Ÿè´·æ ¸å¿ƒåˆçº¦
â”‚   â”‚   â”œâ”€â”€ ğŸ“ Market/             # äº¤æ˜“å¸‚åœº
â”‚   â”‚   â”‚   â””â”€â”€ MarketV2.sol       # å¸‚åœºV2ç‰ˆæœ¬ï¼ˆå¯å‡çº§ï¼‰
â”‚   â”‚   â””â”€â”€ ğŸ“ StakePool/          # è´¨æŠ¼æ± 
â”‚   â”‚       â”œâ”€â”€ StakePool.sol      # è´¨æŠ¼æ± æ ¸å¿ƒåˆçº¦
â”‚   â”‚       â”œâ”€â”€ DelegateGuard.sol  # å§”æ‰˜ä¿æŠ¤
â”‚   â”‚       â””â”€â”€ Initializer.sol    # åˆå§‹åŒ–å™¨
â”‚   â”œâ”€â”€ ğŸ“ GLA/                    # åˆ›ä¸–å¯åŠ¨æ‹å–
â”‚   â”‚   â””â”€â”€ GLA.sol                # æ‹å–åˆçº¦
â”‚   â”œâ”€â”€ ğŸ“ Helper/                 # è¾…åŠ©åˆçº¦
â”‚   â”‚   â””â”€â”€ Helper.sol             # ç”¨æˆ·äº¤äº’è¾…åŠ©
â”‚   â”œâ”€â”€ ğŸ“ RWA/                    # ä»£å¸åˆçº¦
â”‚   â”‚   â””â”€â”€ RWA.sol                # æ ¸å¿ƒä»£å¸
â”‚   â”œâ”€â”€ ğŸ“ prRWA/                  # è´¨æŠ¼å¥–åŠ±ä»£å¸
â”‚   â”‚   â””â”€â”€ ğŸ“ contracts/
â”‚   â”‚       â””â”€â”€ prRWA.sol          # è´¨æŠ¼å¥–åŠ±ä»£å¸
â”‚   â”œâ”€â”€ ğŸ“ STABLE_RWA/             # ç¨³å®šä»£å¸
â”‚   â”‚   â””â”€â”€ ğŸ“ contracts/
â”‚   â”‚       â””â”€â”€ StableRwa.sol      # ç¨³å®šä»£å¸
â”‚   â”œâ”€â”€ ğŸ“ interfaces/             # æ¥å£å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ ğŸ“ common/             # é€šç”¨æ¥å£
â”‚   â”‚   â””â”€â”€ ğŸ“ Market/             # å¸‚åœºæ¥å£
â”‚   â”œâ”€â”€ ğŸ“ mocks/                  # æ¨¡æ‹Ÿåˆçº¦
â”‚   â”‚   â””â”€â”€ MockToken.sol          # æ¨¡æ‹Ÿä»£å¸
â”‚   â”œâ”€â”€ ğŸ“ shared/                 # å…±äº«ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ğŸ“ libraries/          # å·¥å…·åº“
â”‚   â”‚   â”œâ”€â”€ ğŸ“ proxy/              # ä»£ç†ç»„ä»¶
â”‚   â”‚   â””â”€â”€ ğŸ“ utils/              # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ RWALaunchpad.sol           # ä¸»å·¥å‚åˆçº¦
â”‚   â”œâ”€â”€ ProjectParameters.sol      # å‚æ•°é…ç½®åˆçº¦
â”‚   â””â”€â”€ ProjectRegistry.sol        # é¡¹ç›®æ³¨å†Œè¡¨åˆçº¦
â”œâ”€â”€ ğŸ“ test/                       # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ ğŸ“ scripts/                    # éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ ğŸ“ docs/                       # é¡¹ç›®æ–‡æ¡£
â””â”€â”€ README.md                      # é¡¹ç›®è¯´æ˜
```

## ğŸ”§ æ ¸å¿ƒåˆçº¦è¯¦è§£

### RWALaunchpad - ä¸»å·¥å‚åˆçº¦
**æ–‡ä»¶ä½ç½®**: `contracts/RWALaunchpad.sol`

#### ä¸»è¦åŠŸèƒ½
- **é¡¹ç›®åˆ›å»º**: ç”Ÿæˆå”¯ä¸€é¡¹ç›®IDï¼Œç®¡ç†é¡¹ç›®ç”Ÿå‘½å‘¨æœŸ
- **ä¸€é”®éƒ¨ç½²**: `deployWithPreset()` å•å‡½æ•°åˆ›å»ºå®Œæ•´DEX
- **åˆ†æ­¥éƒ¨ç½²**: æ”¯æŒ4é˜¶æ®µéƒ¨ç½²æµç¨‹
- **åŒæ¨¡å¼æ”¯æŒ**: å¿«é€ŸåŸå‹æ¨¡å¼ + ç”Ÿäº§éƒ¨ç½²æ¨¡å¼

#### æ ¸å¿ƒç‰¹æ€§
- **è¶…è½»é‡è®¾è®¡**: ä»…18KBï¼Œå®Œå…¨ç¬¦åˆEVMé™åˆ¶
- **åœ°å€é¢„æµ‹**: ä½¿ç”¨CREATE2ç¡®å®šæ€§åœ°å€
- **é¡¹ç›®ç®¡ç†**: å®Œæ•´çš„é¡¹ç›®æ³¨å†Œã€æŸ¥è¯¢ã€ç®¡ç†åŠŸèƒ½
- **è´¹ç”¨ç³»ç»Ÿ**: å¯é…ç½®éƒ¨ç½²è´¹ç”¨ï¼Œæ”¯æŒè´¹ç”¨æå–

#### å…³é”®å‡½æ•°
```solidity
// ä¸€é”®éƒ¨ç½²
function deployWithPreset(
    string memory projectName,
    uint8 presetType // 0=ä¿å®ˆå‹, 1=å¹³è¡¡å‹, 2=æ¿€è¿›å‹
) external payable returns (uint256 projectId);

// åˆ†æ­¥éƒ¨ç½²
function createProject(string memory projectName) external payable returns (uint256 projectId);
function deployTokens(uint256 projectId, bytes memory rwaBytecode, ...) external;
function deployCoreContracts(uint256 projectId, bytes memory bankBytecode, ...) external;
function deployHelper(uint256 projectId, bytes memory helperBytecode) external;

// æŸ¥è¯¢åŠŸèƒ½
function getProject(uint256 projectId) external view returns (...);
function getAllContracts(uint256 projectId) external view returns (...);
function getProjectCount() external view returns (uint256);
```

### ProjectParameters - å‚æ•°é…ç½®åˆçº¦
**æ–‡ä»¶ä½ç½®**: `contracts/ProjectParameters.sol`

#### ä¸»è¦åŠŸèƒ½
- **å‚æ•°æ¨¡æ¿**: æä¾›ä¸‰ç§é¢„è®¾é…ç½®æ¨¡æ¿
- **å‚æ•°éªŒè¯**: è‡ªåŠ¨éªŒè¯é…ç½®çš„åˆç†æ€§
- **çµæ´»é…ç½®**: æ”¯æŒå®Œå…¨è‡ªå®šä¹‰å‚æ•°é…ç½®

#### é¢„è®¾é…ç½®
- **ä¿å®ˆå‹(Conservative)**: ä½é£é™©ã€ç¨³å®šæ”¶ç›Šé…ç½®
- **å¹³è¡¡å‹(Balanced)**: ä¸­ç­‰é£é™©ã€å¹³è¡¡æ”¶ç›Šé…ç½®
- **æ¿€è¿›å‹(Aggressive)**: é«˜é£é™©ã€é«˜æ”¶ç›Šé…ç½®

#### é…ç½®ç»“æ„
```solidity
struct ProjectConfig {
    TokenConfig tokens;           // ä»£å¸é…ç½®
    BankConfig bank;             // é“¶è¡Œé…ç½®
    MarketPriceConfig marketPrice; // å¸‚åœºä»·æ ¼é…ç½®
    MarketFeeConfig marketFee;   // å¸‚åœºè´¹ç”¨é…ç½®
    MarketPriceFormula priceFormula; // ä»·æ ¼å…¬å¼é…ç½®
    StakePoolRewardConfig stakeReward; // è´¨æŠ¼å¥–åŠ±é…ç½®
    StakePoolFeeConfig stakeFee; // è´¨æŠ¼è´¹ç”¨é…ç½®
    StablecoinConfig stablecoins; // ç¨³å®šå¸é…ç½®
    RoleConfig roles;            // è§’è‰²é…ç½®
    GLAConfig gla;               // GLAæ‹å–é…ç½®
    bool enableGLA;              // æ˜¯å¦å¯ç”¨GLA
}
```

### ProjectRegistry - é¡¹ç›®æ³¨å†Œè¡¨åˆçº¦
**æ–‡ä»¶ä½ç½®**: `contracts/ProjectRegistry.sol`

#### ä¸»è¦åŠŸèƒ½
- **é¡¹ç›®æ³¨å†Œ**: è®°å½•æ‰€æœ‰é€šè¿‡å·¥å‚åˆ›å»ºçš„é¡¹ç›®ä¿¡æ¯
- **åœ°å€æ˜ å°„**: ç»´æŠ¤é¡¹ç›®IDåˆ°åˆçº¦åœ°å€çš„æ˜ å°„å…³ç³»
- **çŠ¶æ€ç®¡ç†**: é¡¹ç›®ç”Ÿå‘½å‘¨æœŸçŠ¶æ€è·Ÿè¸ª
- **æŸ¥è¯¢ç»Ÿè®¡**: ä¸°å¯Œçš„æŸ¥è¯¢å’Œç»Ÿè®¡åŠŸèƒ½

#### æ ¸å¿ƒç‰¹æ€§
- **å®Œæ•´ç´¢å¼•**: æ”¯æŒåç§°ã€åœ°å€ã€æ‰€æœ‰è€…ç­‰å¤šç»´åº¦æŸ¥è¯¢
- **çŠ¶æ€ç®¡ç†**: åˆ›å»ºä¸­ã€æ´»è·ƒã€æš‚åœã€åºŸå¼ƒå››ç§çŠ¶æ€
- **ç»Ÿè®¡åˆ†æ**: é¡¹ç›®æ•°é‡ã€å¹´é¾„ã€æ´»è·ƒåº¦ç­‰ç»Ÿè®¡ä¿¡æ¯
- **åˆ†é¡µæŸ¥è¯¢**: æ”¯æŒå¤§è§„æ¨¡é¡¹ç›®çš„åˆ†é¡µæŸ¥è¯¢

### MarketV2 - äº¤æ˜“å¸‚åœºåˆçº¦
**æ–‡ä»¶ä½ç½®**: `contracts/core/Market/MarketV2.sol`

#### ä¸»è¦åŠŸèƒ½
- **ä»£å¸äº¤æ˜“**: å¤„ç†RWAä»£å¸çš„ä¹°å–äº¤æ˜“
- **ä»·æ ¼å‘ç°**: åŸºäºAMMç®—æ³•çš„åŠ¨æ€ä»·æ ¼å‘ç°
- **æµåŠ¨æ€§ç®¡ç†**: è‡ªåŠ¨åŒ–çš„æµåŠ¨æ€§æä¾›å’Œç§»é™¤
- **å€ºåŠ¡ç®¡ç†**: å®Œå–„çš„å€ºåŠ¡è·Ÿè¸ªå’Œæ¸…ç®—æœºåˆ¶

#### æ ¸å¿ƒç‰¹æ€§
- **åŠ¨æ€å®šä»·**: åŸºäºä¾›éœ€å…³ç³»çš„è‡ªé€‚åº”ä»·æ ¼
- **èµ„é‡‘ç‡ç®¡ç†**: ç›®æ ‡èµ„é‡‘ç‡è‡ªåŠ¨è°ƒèŠ‚æœºåˆ¶
- **åœ°æ¿ä»·ä¿æŠ¤**: åªæ¶¨ä¸è·Œçš„åœ°æ¿ä»·æœºåˆ¶
- **å¤šç¨³å®šå¸æ”¯æŒ**: æ”¯æŒUSDCã€USDTç­‰å¤šç§ç¨³å®šå¸

#### ä»·æ ¼æœºåˆ¶
```solidity
// ä»·æ ¼å…¬å¼
// å½“æ€»ä¾›åº”é‡ â‰¤ p: ä»·æ ¼ = f (åº•ä»·)
// å½“æ€»ä¾›åº”é‡ > p: ä»·æ ¼ = f + (æ€»ä¾›åº”é‡ - p) / k

// èµ„é‡‘ç‡è®¡ç®—
// å½“å‰èµ„é‡‘ç‡ = PSF / (PSF + FSF)
// PSF = ä»·æ ¼æ”¯æ’‘èµ„é‡‘ = (å½“å‰ä»·æ ¼ - åº•ä»·) Ã— (å½“å‰ä¾›åº”é‡ - åº•ä»·ä¾›åº”é‡) / 2
// FSF = åº•ä»·æ”¯æ’‘èµ„é‡‘ = åº•ä»· Ã— åº•ä»·ä¾›åº”é‡
```

#### ä¸»è¦å‡½æ•°
```solidity
// äº¤æ˜“å‡½æ•°
function buy(address token, uint256 tokenWorth, uint256 desired) 
    external returns (uint256 amount, uint256 fee);

function sell(uint256 amount, address token, uint256 desired) 
    external returns (uint256 worth, uint256 repaidDebt1e18, uint256 fee);

// ä»·æ ¼ä¼°ç®—
function estimateBuy(address token, uint256 tokenWorth) 
    external view returns (uint256 amount, uint256 fee, uint256 worth1e18, uint256 newPrice);

function estimateSell(uint256 amount, address token) 
    external view returns (uint256 fee, uint256 worth1e18, uint256 worth, uint256 newPrice, uint256 repaidDebt1e18);
```

### StakePool - è´¨æŠ¼æ± åˆçº¦
**æ–‡ä»¶ä½ç½®**: `contracts/core/StakePool/StakePool.sol`

#### ä¸»è¦åŠŸèƒ½
- **è´¨æŠ¼ç®¡ç†**: ç®¡ç†ç”¨æˆ·è´¨æŠ¼å’Œå¥–åŠ±åˆ†å‘
- **å¥–åŠ±è®¡ç®—**: è‡ªåŠ¨è®¡ç®—å’Œåˆ†é…è´¨æŠ¼å¥–åŠ±
- **æµåŠ¨æ€§æä¾›**: æ”¯æŒæµåŠ¨æ€§æŒ–çŸ¿
- **æ²»ç†å‚ä¸**: è´¨æŠ¼è€…å‚ä¸åè®®æ²»ç†

#### æ ¸å¿ƒç‰¹æ€§
- **å¤šæ± æ”¯æŒ**: æ”¯æŒå¤šä¸ªè´¨æŠ¼æ± 
- **åŠ¨æ€å¥–åŠ±**: æ ¹æ®è´¨æŠ¼é‡å’Œæ—¶é—´åŠ¨æ€è°ƒæ•´å¥–åŠ±
- **æƒé‡åˆ†é…**: å¯é…ç½®çš„æ± æƒé‡åˆ†é…ç³»ç»Ÿ
- **è´¹ç”¨ç®¡ç†**: çµæ´»çš„æç°å’Œé“¸é€ è´¹ç”¨æœºåˆ¶

#### å¥–åŠ±æœºåˆ¶
```solidity
// å¥–åŠ±è®¡ç®—å…¬å¼
reward = (user.amount * pool.accRewardPerShare) - user.rewardDebt

// æ—¥é“¸é€ ç‡é…ç½®
Conservative: 0.3%/å¤© â‰ˆ 110%å¹´åŒ–
Balanced: 0.5%/å¤© â‰ˆ 200%å¹´åŒ–
Aggressive: 0.8%/å¤© â‰ˆ 300%å¹´åŒ–
```

#### ä¸»è¦å‡½æ•°
```solidity
// è´¨æŠ¼ç›¸å…³
function deposit(uint256 _pid, uint256 _amount) external;
function withdraw(uint256 _pid, uint256 _amount) external;
function emergencyWithdraw(uint256 _pid) external;

// å¥–åŠ±ç›¸å…³
function pendingReward(uint256 _pid, address _user) external view returns (uint256);
function claimReward(uint256 _pid) external;

// æ± ç®¡ç†
function add(uint256 _allocPoint, IERC20 _lpToken, bool _withUpdate) external onlyOwner;
function set(uint256 _pid, uint256 _allocPoint, bool _withUpdate) external onlyOwner;
```

### Bank - å€Ÿè´·é“¶è¡Œåˆçº¦
**æ–‡ä»¶ä½ç½®**: `contracts/core/Bank/Bank.sol`

#### ä¸»è¦åŠŸèƒ½
- **è´¨æŠ¼å€Ÿè´·**: åŸºäºè´¨æŠ¼RWAçš„STABLE_RWAå€Ÿè´·æœåŠ¡
- **å€ºåŠ¡ç®¡ç†**: ç”¨æˆ·å€ºåŠ¡è·Ÿè¸ªå’Œç®¡ç†
- **å¯æå–è®¡ç®—**: åŸºäºåœ°æ¿ä»·çš„æå–é¢åº¦è®¡ç®—
- **è´¹ç”¨ç®¡ç†**: å€Ÿè´·è´¹ç”¨çš„æ”¶å–å’Œåˆ†é…

#### æ ¸å¿ƒç‰¹æ€§
- **è¶…é¢æŠµæŠ¼**: åŸºäºè´¨æŠ¼çš„RWAè¿›è¡Œå€Ÿè´·
- **åŠ¨æ€é¢åº¦**: å€Ÿæ¬¾ä¸Šé™ = è´¨æŠ¼RWA Ã— åœ°æ¿ä»·
- **å›ºå®šè´¹ç‡**: åŸºäºè´¨æŠ¼é‡çš„å€Ÿè´·è´¹ç”¨
- **å€ºåŠ¡è·Ÿè¸ª**: ç”¨æˆ·å€ºåŠ¡çš„å®æ—¶è·Ÿè¸ª

#### å€Ÿè´·æœºåˆ¶
```solidity
// å€Ÿè´·é™åˆ¶
require(
    userDebt + amount <= (amountRWA * floorPrice) / 1e18,
    "Bank: exceeds available"
);

// å¯æå–é¢åº¦è®¡ç®—
function withdrawable(address user) external view returns (uint256) {
    uint256 userDebt = debt[user];
    (uint256 amountRWA, ) = IStakePool(pool).userInfo(0, user);
    uint256 floorPrice = IMarket(market).f();
    if (amountRWA * floorPrice <= userDebt * 1e18) {
        return 0;
    }
    return ((amountRWA * floorPrice) - (userDebt * 1e18)) / 1e18;
}
```

#### ä¸»è¦å‡½æ•°
```solidity
// å€Ÿè´·ç›¸å…³
function borrow(uint256 amount) external returns (uint256 borrowed, uint256 fee);
function borrowFrom(address user, uint256 amount) external returns (uint256 borrowed, uint256 fee);
function repay(uint256 amount) external;

// æŸ¥è¯¢å‡½æ•°
function available(address user) public view returns (uint256);
function withdrawable(address user) external view returns (uint256);

// ç®¡ç†å‡½æ•°
function setOptions(address _dev, uint32 _borrowFee) public onlyOwner;
function pause() external onlyOwner;
function unpause() external onlyOwner;
```

### Helper - è¾…åŠ©å·¥å…·åˆçº¦
**æ–‡ä»¶ä½ç½®**: `contracts/Helper/Helper.sol`

#### ä¸»è¦åŠŸèƒ½
- **ä¸€é”®æ“ä½œ**: å°†å¤æ‚çš„å¤šæ­¥éª¤æ“ä½œå°è£…ä¸ºå•æ¬¡è°ƒç”¨
- **æŠ•èµ„ç»„åˆ**: ä¹°å…¥â†’è´¨æŠ¼â†’å€Ÿè´·â†’å¤æŠ•çš„å®Œæ•´æµç¨‹
- **å†æŠ•èµ„**: å®ç°prRWAâ†’ä¹°å…¥RWAâ†’è´¨æŠ¼çš„å¾ªç¯æŠ•èµ„
- **ç”¨æˆ·ä½“éªŒ**: ç®€åŒ–ç”¨æˆ·äº¤äº’ï¼Œå‡å°‘Gasæ¶ˆè€—

#### æ ¸å¿ƒç‰¹æ€§
- **æ“ä½œå°è£…**: å¤æ‚çš„å¤šåˆçº¦äº¤äº’å°è£…ä¸ºç®€å•å‡½æ•°
- **Gasä¼˜åŒ–**: æ‰¹é‡æ“ä½œå‡å°‘ç”¨æˆ·Gasæ¶ˆè€—
- **å®‰å…¨éªŒè¯**: å†…ç½®å‚æ•°éªŒè¯å’Œæ»‘ç‚¹ä¿æŠ¤
- **æµç¨‹ä¼˜åŒ–**: è‡ªåŠ¨åŒ–çš„æŠ•èµ„å’Œå†æŠ•èµ„æµç¨‹

#### ä¸»è¦å‡½æ•°
```solidity
// æŠ•èµ„ç»„åˆæ“ä½œ
function invest(
    address token,        // ç¨³å®šå¸åœ°å€
    uint256 tokenWorth,   // ç¨³å®šå¸æ•°é‡
    uint256 desired,      // æœŸæœ›è·å¾—çš„æœ€å°RWAæ•°é‡
    bool borrow           // æ˜¯å¦å€Ÿè´·
) external;

// å†æŠ•èµ„æ“ä½œ
function reinvest(
    address token,        // ç¨³å®šå¸åœ°å€
    uint256 amount,       // prRWAæ•°é‡
    uint256 desired       // æœ€å¤§æ„¿æ„æ”¯ä»˜çš„ç¨³å®šå¸æ•°é‡
) external;

// å€Ÿè´·æŠ•èµ„
function borrowAndInvest(uint256 amount) external;
```

## ğŸ’° ç»æµæ¨¡å‹

### ä»£å¸ç»æµå­¦

#### RWA (æ ¸å¿ƒä»£å¸)
- **ä»£å¸ç±»å‹**: ERC20ä»£å¸ï¼Œæ”¯æŒé“¸é€ å’Œé”€æ¯
- **é“¸é€ æƒé™**: ä»…æ‰€æœ‰è€…å¯é“¸é€ 
- **ç”¨é€”**: è´¨æŠ¼ã€äº¤æ˜“ã€å€Ÿè´·æŠµæŠ¼å“
- **ç»æµæ¨¡å‹**: åŸºäºä¾›éœ€å…³ç³»çš„åŠ¨æ€ä»·æ ¼

#### prRWA (è´¨æŠ¼å¥–åŠ±ä»£å¸)
- **ä»£å¸ç±»å‹**: ERC20ä»£å¸ï¼Œæ”¯æŒé“¸é€ å’Œé”€æ¯
- **äº§ç”Ÿæœºåˆ¶**: é€šè¿‡è´¨æŠ¼RWAè·å¾—
- **åˆ†é…æ¯”ä¾‹**: æ ¹æ®è´¨æŠ¼é‡å’Œæ—¶é—´åˆ†é…
- **ç”¨é€”**: è´¨æŠ¼å¥–åŠ±ã€åè®®æ¿€åŠ±

#### STABLE_RWA (å€Ÿè´·ä»£å¸)
- **ä»£å¸ç±»å‹**: ERC20ä»£å¸ï¼Œæ”¯æŒé“¸é€ å’Œé”€æ¯
- **äº§ç”Ÿæœºåˆ¶**: é€šè¿‡Bankåˆçº¦å€Ÿè´·äº§ç”Ÿ
- **é”€æ¯æœºåˆ¶**: è¿˜æ¬¾æ—¶é”€æ¯
- **ç”¨é€”**: å€Ÿè´·ã€äº¤æ˜“ã€æµåŠ¨æ€§ç®¡ç†

### æ¿€åŠ±æœºåˆ¶

#### è´¨æŠ¼å¥–åŠ±
```solidity
// å¥–åŠ±è®¡ç®—å…¬å¼
reward = (user.amount * pool.accRewardPerShare) - user.rewardDebt

// æ—¥é“¸é€ ç‡é…ç½®
Conservative: 0.3%/å¤© â‰ˆ 110%å¹´åŒ–
Balanced: 0.5%/å¤© â‰ˆ 200%å¹´åŒ–
Aggressive: 0.8%/å¤© â‰ˆ 300%å¹´åŒ–
```

#### äº¤æ˜“è´¹ç”¨
- **ä¹°å…¥è´¹ç”¨**: 1-4% (åŠ¨æ€è°ƒæ•´)
- **å–å‡ºè´¹ç”¨**: 1-4% (åŠ¨æ€è°ƒæ•´)
- **è´¹ç”¨åˆ†é…**: å¼€å‘è€…è´¹ç”¨ + åè®®è´¹ç”¨

#### å€Ÿè´·åˆ©æ¯
- **åŸºç¡€åˆ©ç‡**: 2-10% (å¹´åŒ–)
- **åŠ¨æ€è°ƒæ•´**: æ ¹æ®å€Ÿè´·éœ€æ±‚è°ƒæ•´
- **åˆ©æ¯åˆ†é…**: å¼€å‘è€…è´¹ç”¨ + åè®®è´¹ç”¨

## ğŸ”’ å®‰å…¨ç‰¹æ€§

### ä»£ç å®‰å…¨

#### å®¡è®¡æŠ¥å‘Š
- **å¤–éƒ¨å®¡è®¡**: ç”±çŸ¥åå®‰å…¨å…¬å¸è¿›è¡Œå®¡è®¡
- **å†…éƒ¨å®¡è®¡**: å›¢é˜Ÿå†…éƒ¨ä»£ç å®¡æŸ¥
- **ç¤¾åŒºå®¡è®¡**: å¼€æºç¤¾åŒºè´¡çŒ®è€…å®¡æŸ¥
- **æŒç»­å®¡è®¡**: å®šæœŸå®‰å…¨è¯„ä¼°

#### æµ‹è¯•è¦†ç›–
- **å•å…ƒæµ‹è¯•**: 100% æ ¸å¿ƒåŠŸèƒ½è¦†ç›–
- **é›†æˆæµ‹è¯•**: å®Œæ•´ä¸šåŠ¡æµç¨‹æµ‹è¯•
- **å‹åŠ›æµ‹è¯•**: æç«¯æƒ…å†µæµ‹è¯•
- **æ¨¡ç³Šæµ‹è¯•**: éšæœºè¾“å…¥æµ‹è¯•

### è¿è¥å®‰å…¨

#### æƒé™ç®¡ç†
```solidity
// è§’è‰²å®šä¹‰
bytes32 public constant ADMIN_ROLE = keccak256("ADMIN_ROLE");
bytes32 public constant OPERATOR_ROLE = keccak256("OPERATOR_ROLE");
bytes32 public constant EMERGENCY_ROLE = keccak256("EMERGENCY_ROLE");
```

#### å¤šç­¾åé’±åŒ…
- **æ²»ç†é’±åŒ…**: 5/9 å¤šç­¾å
- **è¿è¥é’±åŒ…**: 3/5 å¤šç­¾å
- **ç´§æ€¥é’±åŒ…**: 2/3 å¤šç­¾å

#### æ—¶é—´é”
- **æ²»ç†å»¶è¿Ÿ**: 24å°æ—¶
- **å‡çº§å»¶è¿Ÿ**: 48å°æ—¶
- **ç´§æ€¥å»¶è¿Ÿ**: 2å°æ—¶

### é£é™©æ§åˆ¶

#### è¶…é¢æŠµæŠ¼
- **æœ€ä½æŠµæŠ¼ç‡**: 150%
- **æ¸…ç®—é˜ˆå€¼**: 120%
- **æ¸…ç®—æƒ©ç½š**: 5-10%

#### å€ºåŠ¡ç®¡ç†
```solidity
// å€Ÿè´·é™åˆ¶
require(
    userDebt + amount <= (amountRWA * floorPrice) / 1e18,
    "Bank: exceeds available"
);
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- **Node.js**: 16.0.0 æˆ–æ›´é«˜ç‰ˆæœ¬
- **npm**: 8.0.0 æˆ–æ›´é«˜ç‰ˆæœ¬
- **Hardhat**: 2.12.0 æˆ–æ›´é«˜ç‰ˆæœ¬
- **Solidity**: 0.8.19

### å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
```bash
git clone https://github.com/your-repo/dex-contracts.git
cd dex-contracts
```

2. **å®‰è£…ä¾èµ–**
```bash
npm install
# æˆ–
yarn install
```

3. **ç¯å¢ƒé…ç½®**
```bash
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œé…ç½®å¿…è¦çš„ç¯å¢ƒå˜é‡
```

4. **ç¼–è¯‘åˆçº¦**
```bash
npx hardhat compile
```

5. **è¿è¡Œæµ‹è¯•**
```bash
npx hardhat test
```

### æœ¬åœ°å¼€å‘

1. **å¯åŠ¨æœ¬åœ°èŠ‚ç‚¹**
```bash
npx hardhat node
```

2. **éƒ¨ç½²åˆ°æœ¬åœ°ç½‘ç»œ**
```bash
npx hardhat run scripts/deploy-simple.js --network localhost
```

3. **è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶**
```bash
npx hardhat test --network localhost
```

## ğŸ“¦ éƒ¨ç½²æŒ‡å—

### ç½‘ç»œé…ç½®

#### æ”¯æŒçš„ç½‘ç»œ
- **Ethereum Mainnet**: ä¸»ç½‘
- **Polygon**: ä¾§é“¾
- **Arbitrum**: L2è§£å†³æ–¹æ¡ˆ
- **Optimism**: L2è§£å†³æ–¹æ¡ˆ
- **BSC**: å¸å®‰æ™ºèƒ½é“¾

#### ç¯å¢ƒå˜é‡é…ç½®
```env
# ç½‘ç»œé…ç½®
NETWORK=mainnet
RPC_URL=https://mainnet.infura.io/v3/YOUR_PROJECT_ID
PRIVATE_KEY=your_private_key_here

# ä»£å¸åœ°å€ï¼ˆå¦‚æœå·²éƒ¨ç½²ï¼‰
RWA_ADDRESS=0x...
PRRWA_ADDRESS=0x...
STABLERWA_ADDRESS=0x...

# æ ¸å¿ƒåˆçº¦åœ°å€
MARKET_PROXY_ADDRESS=0x...
STAKEPOOL_PROXY_ADDRESS=0x...
BANK_PROXY_ADDRESS=0x...
HELPER_ADDRESS=0x...

# å¤–éƒ¨åœ°å€
USDC_ADDRESS=0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48
USDT_ADDRESS=0xdAC17F958D2ee523a2206206994597C13D831ec7

# åè®®å‚æ•°
MINT_PERCENT_PER_DAY=10
BLOCKS_PER_DAY=7200
WITHDRAW_FEE=50
MINT_FEE=50
BORROW_FEE=50

# APIå¯†é’¥
ETHERSCAN_API_KEY=your_etherscan_api_key
POLYGONSCAN_API_KEY=your_polygonscan_api_key
```

### éƒ¨ç½²æ­¥éª¤

1. **å‡†å¤‡éƒ¨ç½²ç¯å¢ƒ**
```bash
# ç¡®ä¿æœ‰è¶³å¤Ÿçš„æµ‹è¯•å¸
# é…ç½®æ­£ç¡®çš„ç§é’¥å’ŒRPC URL
```

2. **éƒ¨ç½²ä»£å¸åˆçº¦**
```bash
npx hardhat run scripts/deploy-tokens.js --network <network_name>
```

3. **éƒ¨ç½²æ ¸å¿ƒåˆçº¦**
```bash
npx hardhat run scripts/deploy-core.js --network <network_name>
```

4. **éƒ¨ç½²è¾…åŠ©åˆçº¦**
```bash
npx hardhat run scripts/deploy-helper.js --network <network_name>
```

5. **åˆå§‹åŒ–åˆçº¦**
```bash
npx hardhat run scripts/initialize.js --network <network_name>
```

6. **éªŒè¯åˆçº¦**
```bash
npx hardhat run scripts/verify.js --network <network_name>
```

## ğŸ‘¨â€ğŸ’» å¼€å‘æŒ‡å—

### åˆçº¦å¼€å‘è§„èŒƒ

#### ä»£ç é£æ ¼
- **å‘½åè§„èŒƒ**: ä½¿ç”¨é©¼å³°å‘½åæ³•
- **æ³¨é‡Šè§„èŒƒ**: ä½¿ç”¨NatSpecæ ¼å¼
- **ç¼©è¿›è§„èŒƒ**: ä½¿ç”¨4ä¸ªç©ºæ ¼
- **è¡Œé•¿åº¦**: ä¸è¶…è¿‡120å­—ç¬¦

#### å®‰å…¨æœ€ä½³å®è·µ
```solidity
// 1. ä½¿ç”¨SafeMath (Solidity 0.8+ å·²å†…ç½®)
// 2. æ£€æŸ¥é‡å…¥æ”»å‡»
modifier nonReentrant() {
    require(!locked, "Reentrant call");
    locked = true;
    _;
    locked = false;
}

// 3. æƒé™æ£€æŸ¥
modifier onlyRole(bytes32 role) {
    require(hasRole(role, _msgSender()), "AccessControl: access denied");
    _;
}

// 4. äº‹ä»¶è®°å½•
event Deposit(address indexed user, uint256 amount);
```

### æ¥å£å¼€å‘

#### æ¥å£å®šä¹‰è§„èŒƒ
```solidity
// SPDX-License-Identifier: MIT
pragma solidity 0.8.19;

interface IMarket {
    // äº‹ä»¶å®šä¹‰
    event Buy(
        address indexed from,
        address indexed token,
        uint256 input,
        uint256 output,
        uint256 fee,
        uint256 newDebt1e18
    );
    
    // å‡½æ•°å®šä¹‰
    function buy(
        address token,
        uint256 tokenWorth,
        uint256 desired
    ) external returns (uint256 amount, uint256 fee);
    
    function sell(
        uint256 amount,
        address token,
        uint256 desired
    ) external returns (uint256 worth, uint256 repaidDebt1e18, uint256 fee);
    
    // æŸ¥è¯¢å‡½æ•°
    function estimateBuy(address token, uint256 tokenWorth)
        external
        view
        returns (
            uint256 amount,
            uint256 fee,
            uint256 worth1e18,
            uint256 newPrice
        );
}
```

## ğŸ§ª æµ‹è¯•æŒ‡å—

### æµ‹è¯•ç±»å‹

#### å•å…ƒæµ‹è¯•
- **åŠŸèƒ½æµ‹è¯•**: æµ‹è¯•å•ä¸ªå‡½æ•°çš„åŠŸèƒ½
- **è¾¹ç•Œæµ‹è¯•**: æµ‹è¯•è¾¹ç•Œæ¡ä»¶å’Œå¼‚å¸¸æƒ…å†µ
- **æƒé™æµ‹è¯•**: æµ‹è¯•æƒé™æ§åˆ¶æœºåˆ¶

#### é›†æˆæµ‹è¯•
- **åˆçº¦äº¤äº’**: æµ‹è¯•åˆçº¦é—´çš„äº¤äº’
- **ä¸šåŠ¡æµç¨‹**: æµ‹è¯•å®Œæ•´çš„ä¸šåŠ¡æµç¨‹
- **äº‹ä»¶éªŒè¯**: éªŒè¯äº‹ä»¶æ­£ç¡®è§¦å‘

#### å‹åŠ›æµ‹è¯•
- **è´Ÿè½½æµ‹è¯•**: æµ‹è¯•é«˜è´Ÿè½½ä¸‹çš„æ€§èƒ½
- **gasä¼˜åŒ–**: æµ‹è¯•gasä½¿ç”¨æƒ…å†µ
- **å¹¶å‘æµ‹è¯•**: æµ‹è¯•å¹¶å‘æ“ä½œ

### æµ‹è¯•å‘½ä»¤

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npx hardhat test

# è¿è¡Œç‰¹å®šæµ‹è¯•æ–‡ä»¶
npx hardhat test test/RWA.test.js

# è¿è¡Œæµ‹è¯•å¹¶æ˜¾ç¤ºgasä½¿ç”¨æƒ…å†µ
npx hardhat test --gas

# è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
npx hardhat coverage

# è¿è¡Œæµ‹è¯•å¹¶æ˜¾ç¤ºè¯¦ç»†æ—¥å¿—
npx hardhat test --verbose
```

## ğŸ“š APIæ–‡æ¡£

### Marketåˆçº¦API

#### äº¤æ˜“å‡½æ•°

##### buy
è´­ä¹°RWAä»£å¸
```solidity
function buy(
    address token,        // æ”¯ä»˜ä»£å¸åœ°å€
    uint256 tokenWorth,   // æ”¯ä»˜ä»£å¸æ•°é‡
    uint256 desired       // æœŸæœ›è·å¾—çš„æœ€å°RWAæ•°é‡
) external returns (
    uint256 amount,       // å®é™…è·å¾—çš„RWAæ•°é‡
    uint256 fee          // æ‰‹ç»­è´¹
);
```

**å‚æ•°è¯´æ˜**:
- `token`: ç”¨äºæ”¯ä»˜çš„ç¨³å®šå¸åœ°å€ï¼ˆå¦‚USDCã€USDTï¼‰
- `tokenWorth`: æ”¯ä»˜çš„ç¨³å®šå¸æ•°é‡
- `desired`: æœŸæœ›è·å¾—çš„æœ€å°RWAæ•°é‡ï¼Œç”¨äºæ»‘ç‚¹ä¿æŠ¤

**è¿”å›å€¼**:
- `amount`: å®é™…è·å¾—çš„RWAæ•°é‡
- `fee`: æ”¯ä»˜çš„æ‰‹ç»­è´¹ï¼ˆRWAä»£å¸ï¼‰

**äº‹ä»¶**:
```solidity
event Buy(
    address indexed from,     // è´­ä¹°è€…åœ°å€
    address indexed token,    // æ”¯ä»˜ä»£å¸åœ°å€
    uint256 input,           // è¾“å…¥æ•°é‡
    uint256 output,          // è¾“å‡ºæ•°é‡
    uint256 fee,             // æ‰‹ç»­è´¹
    uint256 newDebt1e18      // æ–°å¢å€ºåŠ¡
);
```

##### sell
å–å‡ºRWAä»£å¸
```solidity
function sell(
    uint256 amount,      // å–å‡ºçš„RWAæ•°é‡
    address token,       // æ¥æ”¶ä»£å¸åœ°å€
    uint256 desired      // æœŸæœ›è·å¾—çš„æœ€å°ç¨³å®šå¸æ•°é‡
) external returns (
    uint256 worth,       // å®é™…è·å¾—çš„ç¨³å®šå¸æ•°é‡
    uint256 repaidDebt1e18, // å¿è¿˜çš„å€ºåŠ¡
    uint256 fee          // æ‰‹ç»­è´¹
);
```

**å‚æ•°è¯´æ˜**:
- `amount`: è¦å–å‡ºçš„RWAæ•°é‡
- `token`: æ¥æ”¶çš„ç¨³å®šå¸åœ°å€
- `desired`: æœŸæœ›è·å¾—çš„æœ€å°ç¨³å®šå¸æ•°é‡

**è¿”å›å€¼**:
- `worth`: å®é™…è·å¾—çš„ç¨³å®šå¸æ•°é‡
- `repaidDebt1e18`: å¿è¿˜çš„å€ºåŠ¡æ•°é‡
- `fee`: æ”¯ä»˜çš„æ‰‹ç»­è´¹

**äº‹ä»¶**:
```solidity
event Sell(
    address indexed from,        // å–å‡ºè€…åœ°å€
    address indexed token,       // æ¥æ”¶ä»£å¸åœ°å€
    uint256 input,              // è¾“å…¥æ•°é‡
    uint256 output,             // è¾“å‡ºæ•°é‡
    uint256 fee,                // æ‰‹ç»­è´¹
    uint256 repaidDebt1e18      // å¿è¿˜çš„å€ºåŠ¡
);
```

#### æŸ¥è¯¢å‡½æ•°

##### estimateBuy
ä¼°ç®—è´­ä¹°ç»“æœ
```solidity
function estimateBuy(
    address token,       // æ”¯ä»˜ä»£å¸åœ°å€
    uint256 tokenWorth   // æ”¯ä»˜ä»£å¸æ•°é‡
) external view returns (
    uint256 amount,      // é¢„è®¡è·å¾—çš„RWAæ•°é‡
    uint256 fee,         // é¢„è®¡æ‰‹ç»­è´¹
    uint256 worth1e18,   // å®é™…ä»·å€¼ï¼ˆ1e18ç²¾åº¦ï¼‰
    uint256 newPrice     // äº¤æ˜“åçš„æ–°ä»·æ ¼
);
```

**ä½¿ç”¨ç¤ºä¾‹**:
```javascript
const usdcAmount = ethers.utils.parseUnits("1000", 6);
const estimate = await market.estimateBuy(usdc.address, usdcAmount);

console.log(`é¢„è®¡è·å¾—RWA: ${ethers.utils.formatEther(estimate.amount)}`);
console.log(`é¢„è®¡æ‰‹ç»­è´¹: ${ethers.utils.formatEther(estimate.fee)}`);
console.log(`å®é™…ä»·å€¼: ${ethers.utils.formatEther(estimate.worth1e18)}`);
console.log(`æ–°ä»·æ ¼: ${ethers.utils.formatEther(estimate.newPrice)}`);
```

##### estimateSell
ä¼°ç®—å–å‡ºç»“æœ
```solidity
function estimateSell(
    uint256 amount,      // å–å‡ºçš„RWAæ•°é‡
    address token        // æ¥æ”¶ä»£å¸åœ°å€
) external view returns (
    uint256 fee,         // é¢„è®¡æ‰‹ç»­è´¹
    uint256 worth1e18,   // é¢„è®¡è·å¾—çš„ç¨³å®šå¸æ•°é‡ï¼ˆ1e18ç²¾åº¦ï¼‰
    uint256 worth,       // é¢„è®¡è·å¾—çš„ç¨³å®šå¸æ•°é‡
    uint256 newPrice,    // äº¤æ˜“åçš„æ–°ä»·æ ¼
    uint256 repaidDebt1e18 // é¢„è®¡å¿è¿˜çš„å€ºåŠ¡
);
```

### StakePoolåˆçº¦API

#### è´¨æŠ¼å‡½æ•°

##### deposit
è´¨æŠ¼ä»£å¸
```solidity
function deposit(
    uint256 _pid,    // æ± ID
    uint256 _amount  // è´¨æŠ¼æ•°é‡
) external;
```

**äº‹ä»¶**:
```solidity
event Deposit(
    address indexed user,   // ç”¨æˆ·åœ°å€
    uint256 indexed pid,    // æ± ID
    uint256 amount         // è´¨æŠ¼æ•°é‡
);
```

##### withdraw
æå–è´¨æŠ¼
```solidity
function withdraw(
    uint256 _pid,    // æ± ID
    uint256 _amount  // æå–æ•°é‡
) external;
```

**äº‹ä»¶**:
```solidity
event Withdraw(
    address indexed user,   // ç”¨æˆ·åœ°å€
    uint256 indexed pid,    // æ± ID
    uint256 amount         // æå–æ•°é‡
);
```

#### æŸ¥è¯¢å‡½æ•°

##### pendingReward
æŸ¥è¯¢å¾…é¢†å–å¥–åŠ±
```solidity
function pendingReward(
    uint256 _pid,    // æ± ID
    address _user    // ç”¨æˆ·åœ°å€
) external view returns (uint256);
```

**ä½¿ç”¨ç¤ºä¾‹**:
```javascript
const poolId = 0; // RWAè´¨æŠ¼æ± 
const pending = await stakePool.pendingReward(poolId, userAddress);
console.log(`å¾…é¢†å–å¥–åŠ±: ${ethers.utils.formatEther(pending)} prRWA`);
```

### Bankåˆçº¦API

#### å€Ÿè´·å‡½æ•°

##### borrow
å€Ÿæ¬¾
```solidity
function borrow(
    uint256 amount    // å€Ÿæ¬¾æ•°é‡
) external;
```

**äº‹ä»¶**:
```solidity
event Borrow(
    address indexed user,   // å€Ÿæ¬¾äººåœ°å€
    uint256 amount         // å€Ÿæ¬¾æ•°é‡
);
```

##### repay
è¿˜æ¬¾
```solidity
function repay(
    uint256 amount    // è¿˜æ¬¾æ•°é‡
) external;
```

**äº‹ä»¶**:
```solidity
event Repay(
    address indexed user,   // è¿˜æ¬¾äººåœ°å€
    uint256 amount         // è¿˜æ¬¾æ•°é‡
);
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

### å¼€å‘ç¯å¢ƒè®¾ç½®

1. **Forké¡¹ç›®**
```bash
# Forké¡¹ç›®åˆ°ä½ çš„GitHubè´¦æˆ·
# ç„¶åå…‹éš†ä½ çš„fork
git clone https://github.com/your-username/dex-contracts.git
cd dex-contracts
```

2. **åˆ›å»ºå¼€å‘åˆ†æ”¯**
```bash
git checkout -b feature/your-feature-name
```

3. **å®‰è£…ä¾èµ–**
```bash
npm install
```

4. **è¿è¡Œæµ‹è¯•**
```bash
npx hardhat test
```

### ä»£ç è§„èŒƒ

#### Solidityä»£ç è§„èŒƒ
```solidity
// SPDX-License-Identifier: MIT
pragma solidity 0.8.19;

import "@openzeppelin/contracts/token/ERC20/IERC20.sol";
import "@openzeppelin/contracts/access/Ownable.sol";

/**
 * @title ContractName
 * @dev åˆçº¦åŠŸèƒ½æè¿°
 * @author Your Name
 * @notice è¿™ä¸ªåˆçº¦ç”¨äº...
 * @dev è¯¦ç»†çš„æŠ€æœ¯è¯´æ˜
 */
contract ContractName is Ownable {
    // çŠ¶æ€å˜é‡
    IERC20 public token;
    uint256 public totalSupply;
    
    // äº‹ä»¶
    event EventName(address indexed user, uint256 amount);
    
    // é”™è¯¯å®šä¹‰
    error InsufficientBalance(uint256 available, uint256 required);
    
    // ä¿®é¥°ç¬¦
    modifier onlyValidAmount(uint256 amount) {
        require(amount > 0, "Amount must be greater than 0");
        _;
    }
    
    // æ„é€ å‡½æ•°
    constructor(address _token) {
        token = IERC20(_token);
    }
    
    // å¤–éƒ¨å‡½æ•°
    function externalFunction(uint256 amount) 
        external 
        onlyOwner 
        onlyValidAmount(amount) 
    {
        // å‡½æ•°å®ç°
        emit EventName(msg.sender, amount);
    }
}
```

## â“ å¸¸è§é—®é¢˜

### æŠ€æœ¯é—®é¢˜

#### Q: å¦‚ä½•è®¡ç®—äº¤æ˜“æ»‘ç‚¹ï¼Ÿ
A: æ»‘ç‚¹è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š
```javascript
// é¢„æœŸä»·æ ¼
const expectedPrice = inputAmount / expectedOutput;

// å®é™…ä»·æ ¼
const actualPrice = inputAmount / actualOutput;

// æ»‘ç‚¹ç™¾åˆ†æ¯”
const slippage = ((expectedPrice - actualPrice) / expectedPrice) * 100;
```

#### Q: å¦‚ä½•å¤„ç†ä»·æ ¼é¢„è¨€æœºï¼Ÿ
A: æˆ‘ä»¬ä½¿ç”¨Chainlinkä»·æ ¼é¢„è¨€æœºï¼š
```solidity
import "@chainlink/contracts/src/v0.8/interfaces/AggregatorV3Interface.sol";

contract PriceOracle {
    AggregatorV3Interface public priceFeed;
    
    constructor(address _priceFeed) {
        priceFeed = AggregatorV3Interface(_priceFeed);
    }
    
    function getLatestPrice() public view returns (int) {
        (, int price,,,) = priceFeed.latestRoundData();
        return price;
    }
}
```

### ä¸šåŠ¡é—®é¢˜

#### Q: å¦‚ä½•å‚ä¸åè®®ç®¡ç†ï¼Ÿ
A: åè®®ç®¡ç†æµç¨‹ï¼š
1. æŒæœ‰RWAä»£å¸
2. è´¨æŠ¼RWAè·å¾—pr_RWAå¥–åŠ±
3. é€šè¿‡æ‰€æœ‰è€…è¿›è¡Œå‚æ•°è°ƒæ•´
4. å‚ä¸åè®®å‡çº§å†³ç­–

#### Q: å¦‚ä½•è®¡ç®—è´¨æŠ¼å¥–åŠ±ï¼Ÿ
A: å¥–åŠ±è®¡ç®—å…¬å¼ï¼š
```solidity
// ç”¨æˆ·å¥–åŠ± = (ç”¨æˆ·è´¨æŠ¼é‡ * æ± ç´¯è®¡å¥–åŠ±) - ç”¨æˆ·å¥–åŠ±å€ºåŠ¡
reward = (user.amount * pool.accRewardPerShare) - user.rewardDebt;
```

## ğŸ“ æ›´æ–°æ—¥å¿—

### v2.0.0 (2025-01-15)
#### ğŸš€ æ–°åŠŸèƒ½
- æ·»åŠ MarketV2åˆçº¦ï¼Œæ”¯æŒå€ºåŠ¡ç®¡ç†
- å®ç°Bondsåˆçº¦é›†æˆ
- æ–°å¢åœ°æ¿ä»·ä¿æŠ¤æœºåˆ¶
- æ·»åŠ ç´§æ€¥æš‚åœåŠŸèƒ½

#### ğŸ”§ æ”¹è¿›
- ä¼˜åŒ–gasä½¿ç”¨æ•ˆç‡
- æ”¹è¿›ä»·æ ¼å‘ç°ç®—æ³•
- å¢å¼ºå®‰å…¨æœºåˆ¶
- å®Œå–„æµ‹è¯•è¦†ç›–

### v1.0.0 (2023-10-01)
#### ğŸ‰ é¦–æ¬¡å‘å¸ƒ
- åŸºç¡€äº¤æ˜“åŠŸèƒ½
- è´¨æŠ¼å¥–åŠ±ç³»ç»Ÿ
- å€Ÿè´·æœåŠ¡
- æƒé™ç®¡ç†

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶